function [ x, y ] = FiniteDiff1(p,q,f,a0,a1,b0,b1,A,B,from,to,n)
h = (to-from)/(n-1);
x = from:h:to;
b = zeros(n,1);
i = ones(3*n-2,1);
j = ones(3*n-2,1);
k = ones(3*n-2,1);
i(1) = 1;
j(1) = 1;
k(1) = (2*h*a0-3*a1) +a1*(1-h/2 *p(x(2)))/(1+h/2*p(x(2)));
i(2) = 1;
j(2) = 2;
k(2) = 4*a1-a1*(2-h*h*q(x(2)))/(1+h/2*p(x(2)));
% M(1,1) = (2*h*a0-3*a1) +a1*(1-h/2 *p(x(2)))/(1+h/2*p(x(2)));
% M(1,2) = 4*a1-a1*(2-h*h*q(x(2)))/(1+h/2*p(x(2)));
b(1) = 2*A*h+a1*h*h*f(x(2))/(1+h/2*p(x(2)));
iii = 2;
for ii=3:3:(3*n-4)
i(ii) = iii;
j(ii) = iii+1;
k(ii) = 1 + h./2 * p(x(iii));
i(ii+1) = iii;
j(ii+1) = iii;
k(ii+1) = -(2 - h.^2 * q(x(iii)));
i(ii+2) = iii;
j(ii+2) = iii-1;
k(ii+2) = (1 - h./2 * p(x(iii)));
b(iii) = h^2 * f(x(iii));
iii = iii+1;
end
i(3*n-3) = n;
j(3*n-3) = n-1;
k(3*n-3) = -4*b1+b1*(2-h*h*q(x(n)))/(1-h/2*p(x((n))));
i(3*n-2) = n;
j(3*n-2) = n;
k(3*n-2) =(2*h*b0+3*b1) -b1*(1+h/2)/(1-h/2*p(x((n))));
% M(n,n-1) = -4*b1+b1*(2-h*h*q(x(n)))/(1-h/2*p(x((n))));
% M(n,n) = (2*h*b0+3*b1) -b1*(1+h/2)/(1-h/2*p(x((n))));
M = sparse(i,j,k, n ,n);
b(n) = 2*B*h-b1*h*h*f(x(n))/(1-h/2*p(x((n))));
y = M\b;
y = y';
end